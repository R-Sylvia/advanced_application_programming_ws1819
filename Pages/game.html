<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="author" content="Anna Lukjanenko" />
    <meta name="description" content="Advanced Software Programming" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
    </style>
    <link href="gameStylesheet.css" rel="stylesheet" />
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <title>GrabIT Game page</title>
</head>
<body>
    <div class="wrapper">
        <div class="space"></div>
        <div class="titlegrid" style="min-height:30px">
            <div class="title">Let's Play Grab <letterspace style="letter-spacing:10px">IT</letterspace></div>
            <div class="registrationgrid">
                <button class="button" type="button" onclick="window.location.href='menu.html'">Ex <letterspace style="letter-spacing:5px">IT</letterspace></button>
            </div>
        </div>
        <div class="game">
            <div class="scoreboard">
                SCOREBOARD
                <div class="table">
                    <ul class="scoreentry" id="scoreentry">
                        <p class="username">TestUser1</p>
                        <p class="score">0</p>
                    </ul>
                </div>
            </div>
            <div id="messageArea" class="row">
                <div class="chatbox">
                    <div class="chatlogs">
                        <div class="chatentry" id="chatentry"></div>
                    </div>
                    <form id="messageForm">
                        <div class="chatform">
                            <textarea class="form-control" id="message"></textarea>
                            <input type="submit" class="SendBtn" value="Send"/>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="canvas">
                <canvas class="canvas"></canvas>
                <script src="canvas.js"></script>
            </div>
        </div>
    </div>
    <script>
        var socket = io.connect();
        var $messageForm = $('#messageForm');
        var $message = $('#message');
        var $chatentry = $('#chatentry');
        var $scoreentry = $('#scoreentry');

        //Client presses "Send" button for sending the message
        $messageForm.submit(function (e) {
            e.preventDefault();
            socket.emit('send message', $message.val());
            $message.val('');
        });
        //SERVER SIDE CODE
        /*
        //Send Message
        socket.on('send message', function (data) {
            io.sockets.emit('new message', { msg: data, user: socket.username });
        });
        */

        //Receiving new message and displaying it
        socket.on('new message', function (data) {
            $chatentry.append('<p class="username"><strong>' + data.user + '</strong>:</p>');
            $chatentry.append('<p class="usermessage">' + data.msg + '</p>');
        });

        //Receiving "update scoreboard" message from server
        socket.on('update scoreboard', function (data) {
            var html = '';
            for (i = 1; i <= data.length; i++) {
                html += '<p class="username">' + data[i].user + '</p>';
                html += '<p class="score">' + data[i].msg + '</p>';
            }
            $scoreentry.html(html);
        });
        //SERVER SIDE CODE
        /*
        //Score has changed of current players
        socket.on('score changed', function (score) {
            //update list of current players and its scores
            //update DB
            //update scoreboard
            io.sockets.emit('update scorboard', {listCurrentPlayers});
        });
        */

    </script>
</body>
</html>